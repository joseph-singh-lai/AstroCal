<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Astronomy Explorer - Interactive astronomy events, satellite imagery, and sky map for La Brea, Trinidad & Tobago">
    <title>Astronomy Explorer - La Brea, Trinidad & Tobago</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Leaflet CSS for GIBS map -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script>
        // NASA API Configuration (inlined to avoid MIME type issues on Vercel)
        window.NASA_API_CONFIG = {
            apiKey: 'X2dVwncjWkOz6OrVnWpO16W5eWE6NaAXz3BHH67Q',
            baseUrl: 'https://api.nasa.gov',
            
            // Cache settings (in milliseconds)
            cacheSettings: {
                apod: 24 * 60 * 60 * 1000,      // 24 hours (APOD is daily)
                donki: 6 * 60 * 60 * 1000,      // 6 hours (solar events update frequently)
                eonet: 12 * 60 * 60 * 1000,     // 12 hours (natural events)
            },
            
            // Date ranges for fetching events
            dateRanges: {
                donki: {
                    startDate: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], // 30 days ago
                    endDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0]   // 30 days ahead
                },
                eonet: {
                    days: 30 // Last 30 days
                }
            }
        };
        
        // Also expose as const for backward compatibility
        const NASA_API_CONFIG = window.NASA_API_CONFIG;
        
        // Note: Astronomy API (api.astronomyapi.com) requires server-side proxy due to CORS
        // Replaced with Open-Meteo Astronomy API (free, CORS-enabled, no key required)
        // Old credentials kept in api-info-DO-NOT-DELETE.txt for reference
    </script>
</head>
<body>
    <!-- Animated Planets -->
    <div class="planet-1"></div>
    <div class="planet-2"></div>
    <div class="planet-3"></div>
    <div class="planet-4"></div>
    <div class="planet-5"></div>
    <div class="planet-6"></div>
    
    <!-- Animated Galaxies/Nebulae -->
    <div class="galaxy-1"></div>
    <div class="galaxy-2"></div>
    <div class="galaxy-3"></div>
    
    <div id="app">
        <header class="main-header">
            <div class="header-content">
                <h1>Astronomy Explorer</h1>
                <p class="location-subtitle">La Brea, Trinidad & Tobago</p>
            </div>
            <nav class="main-nav">
                <button class="nav-button active" data-section="events">üìÖ Events</button>
                <button class="nav-button" data-section="gibs">üõ∞Ô∏è Satellite Imagery</button>
                <button class="nav-button" data-section="sky">‚≠ê Sky Map</button>
            </nav>
        </header>

        <main class="main-content">
            <!-- Events Section -->
            <section id="events-section" class="content-section active">
                <div class="events-layout">
                    <aside class="filter-panel">
                        <h2>Filters</h2>
                        <div class="filter-options">
                            <label class="filter-checkbox">
                                <input type="checkbox" value="meteor" checked>
                                <span>Meteor Showers</span>
                            </label>
                            <label class="filter-checkbox">
                                <input type="checkbox" value="planet" checked>
                                <span>Planet Visibility</span>
                            </label>
                            <label class="filter-checkbox">
                                <input type="checkbox" value="iss" checked>
                                <span>ISS Passes</span>
                            </label>
                            <label class="filter-checkbox">
                                <input type="checkbox" value="apod" checked>
                                <span>NASA APOD</span>
                            </label>
                            <label class="filter-checkbox">
                                <input type="checkbox" value="solar" checked>
                                <span>Solar Events</span>
                            </label>
                            <label class="filter-checkbox">
                                <input type="checkbox" value="astronomy" checked>
                                <span>Astronomy</span>
                            </label>
                        </div>
                        <button id="applyFilters" class="apply-button">Apply</button>
                        <button id="refreshNASA" class="apply-button" style="margin-top: 0.5rem; background-color: var(--accent-secondary); font-size: 0.9rem; padding: 0.625rem;">
                            üîÑ Refresh
                        </button>
                    </aside>

                    <div class="events-content">
                        <section class="controls-section">
                            <div class="search-container">
                                <input 
                                    type="text" 
                                    id="searchInput" 
                                    class="search-input" 
                                    placeholder="Search events..."
                                    aria-label="Search events"
                                >
                            </div>

                            <div class="location-container">
                                <div class="location-info">
                                    <div class="location-status-wrapper">
                                        <span id="locationStatus" class="location-status">üìç Using default location: La Brea, Trinidad & Tobago</span>
                                        <span class="location-privacy">Your location is only used locally and never shared with external services.</span>
                                    </div>
                                    <div class="location-buttons">
                                        <button id="locationButton" class="location-button" aria-label="Request location access">
                                            üìç Use My Location
                                        </button>
                                        <button id="clearLocationButton" class="location-button location-button-secondary" aria-label="Clear saved location" style="display: none;">
                                            üîÑ Reset
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </section>

                        <section class="events-section">
                            <div id="eventsContainer" class="events-container" role="list">
                                <!-- Events will be dynamically rendered here -->
                            </div>
                        </section>
                    </div>
                </div>

            <section id="eventDetail" class="event-detail-section" aria-live="polite">
                <!-- Event details will be populated dynamically -->
            </section>
            </section>

            <!-- GIBS Satellite Imagery Section -->
            <section id="gibs-section" class="content-section">
                <div class="section-header">
                    <h2>üõ∞Ô∏è NASA Satellite Imagery Explorer</h2>
                    <p class="section-description">Explore Earth using NASA's Global Imagery Browse Services (GIBS)</p>
                </div>
                
                <div class="map-controls">
                    <div class="layer-controls">
                        <label for="layerSelect">Satellite Layer:</label>
                        <select id="layerSelect" class="layer-select">
                            <option value="osm">OpenStreetMap (Default)</option>
                            <option value="blueMarble">Blue Marble (Day) - NASA GIBS</option>
                            <option value="blueMarbleNight">Night Lights (2020) - NASA GIBS</option>
                            <option value="modisTerra">MODIS Terra True Color - NASA GIBS</option>
                            <option value="modisAqua">MODIS Aqua True Color - NASA GIBS</option>
                            <option value="fires">Active Fires - NASA GIBS</option>
                            <option value="aerosol">Aerosol Index - NASA GIBS</option>
                        </select>
                    </div>
                    <button id="centerMapButton" class="map-button">üìç Center on My Location</button>
                    <button id="centerDefaultButton" class="map-button">üìç Center on La Brea</button>
                </div>
                
                <div id="gibsMap" class="map-container"></div>
                <div class="map-info">
                    <p>Pan and zoom to explore satellite imagery. Use the layer selector to switch between different views.</p>
                </div>
            </section>

            <!-- Interactive Sky Map Section -->
            <section id="sky-section" class="content-section">
                <div class="section-header">
                    <h2>‚≠ê Interactive Sky Map</h2>
                    <p class="section-description">Explore the night sky over your location</p>
                </div>
                
                <div class="sky-controls">
                    <div class="sky-control-group">
                        <label for="skyTimeSelect">View Time:</label>
                        <input type="datetime-local" id="skyTimeSelect" class="sky-input">
                        <button id="useCurrentTime" class="sky-button">Now</button>
                    </div>
                    <div class="sky-control-group">
                        <label>
                            <input type="checkbox" id="showConstellations" checked>
                            Show Constellations
                        </label>
                        <label>
                            <input type="checkbox" id="showPlanets" checked>
                            Show Planets
                        </label>
                        <label>
                            <input type="checkbox" id="showStars" checked>
                            Show Stars
                        </label>
                    </div>
                    <button id="centerSkyMapButton" class="sky-button">üìç Use My Location</button>
                </div>
                
                <div id="skyMap" class="sky-map-container">
                    <canvas id="skyCanvas"></canvas>
                    <div id="skyInfo" class="sky-info">
                        <p>Click on objects in the sky map to learn more</p>
                    </div>
                </div>
                
                <div class="sky-legend">
                    <h3>Visible Events</h3>
                    <div id="visibleEvents" class="visible-events-list">
                        <!-- Will be populated with events visible at current time -->
                    </div>
                </div>
            </section>
        </main>

        <footer class="main-footer">
            <p>Astronomy Events ‚Äì La Brea, Trinidad & Tobago</p>
            <p class="footer-credit">Built with vanilla JavaScript, HTML, and CSS</p>
        </footer>
    </div>

    <!-- Leaflet JS for GIBS map -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="script.js"></script>
    <script src="gibs-map.js"></script>
    <script src="sky-map.js"></script>
</body>
</html>

