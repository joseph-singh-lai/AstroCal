<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Astronomy Explorer - Interactive astronomy events, satellite imagery, and sky map for La Brea, Trinidad & Tobago">
    <title>Astronomy Explorer - La Brea, Trinidad & Tobago</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üî≠</text></svg>">
    <link rel="stylesheet" href="styles.css">
    <!-- Leaflet CSS for GIBS map -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script>
        // NASA API Configuration (inlined to avoid MIME type issues on Vercel)
        window.NASA_API_CONFIG = {
            apiKey: 'X2dVwncjWkOz6OrVnWpO16W5eWE6NaAXz3BHH67Q',
            baseUrl: 'https://api.nasa.gov',
            
            // Cache settings (in milliseconds)
            cacheSettings: {
                apod: 24 * 60 * 60 * 1000,      // 24 hours (APOD is daily)
                donki: 6 * 60 * 60 * 1000,      // 6 hours (solar events update frequently)
                eonet: 12 * 60 * 60 * 1000,     // 12 hours (natural events)
            },
            
            // Date ranges for fetching events
            dateRanges: {
                donki: {
                    startDate: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], // 30 days ago
                    endDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0]   // 30 days ahead
                },
                eonet: {
                    days: 30 // Last 30 days
                }
            }
        };
        
        // Also expose as const for backward compatibility
        const NASA_API_CONFIG = window.NASA_API_CONFIG;
        
        // Note: Astronomy API (api.astronomyapi.com) requires server-side proxy due to CORS
        // Replaced with Open-Meteo Astronomy API (free, CORS-enabled, no key required)
        // Old credentials kept in api-info-DO-NOT-DELETE.txt for reference
    </script>
</head>
<body>
    <!-- Central Sun -->
    <div class="sun"></div>
    
    <!-- Orbital Container -->
    <div class="orbit-container">
        <!-- Animated Planets in Orbit -->
        <div class="planet-1"></div>
        <div class="planet-2"></div>
        <div class="planet-3"></div>
        <div class="planet-4"></div>
        <div class="planet-5"></div>
        <div class="planet-6"></div>
    </div>
    
    <!-- Animated Galaxies/Nebulae -->
    <div class="galaxy-1"></div>
    <div class="galaxy-2"></div>
    <div class="galaxy-3"></div>
    
    <div id="app">
        <header class="main-header">
            <div class="header-content">
                <h1>Astronomy Explorer</h1>
                <p class="location-subtitle">La Brea, Trinidad & Tobago</p>
            </div>
            <nav class="main-nav">
                <button class="nav-button active" data-section="events">üìÖ Events</button>
                <button class="nav-button" data-section="gibs">üõ∞Ô∏è Satellite Imagery</button>
                <a href="sky-map.html" class="nav-button" style="text-decoration: none; display: inline-block;">‚≠ê Sky Map</a>
                <button class="nav-button" data-section="glossary">üìñ Glossary</button>
            </nav>
        </header>

        <main class="main-content">
            <!-- Events Section -->
            <section id="events-section" class="content-section active">
                <div class="events-layout">
                    <aside class="filter-panel">
                        <h2>Filters</h2>
                        <div class="filter-options">
                            <label class="filter-checkbox">
                                <input type="checkbox" value="meteor">
                                <span>Meteor Showers</span>
                            </label>
                            <label class="filter-checkbox">
                                <input type="checkbox" value="planet">
                                <span>Planet Visibility</span>
                            </label>
                            <label class="filter-checkbox">
                                <input type="checkbox" value="iss">
                                <span>ISS Passes</span>
                            </label>
                            <label class="filter-checkbox">
                                <input type="checkbox" value="apod" checked>
                                <span>NASA APOD</span>
                            </label>
                            <label class="filter-checkbox">
                                <input type="checkbox" value="solar">
                                <span>Solar Events</span>
                            </label>
                            <label class="filter-checkbox">
                                <input type="checkbox" value="natural">
                                <span>Natural Events</span>
                            </label>
                            <label class="filter-checkbox">
                                <input type="checkbox" value="workshop">
                                <span>Workshops</span>
                            </label>
                            <label class="filter-checkbox">
                                <input type="checkbox" value="astronomy">
                                <span>Astronomy</span>
                            </label>
                        </div>
                        <button id="refreshNASA" class="apply-button" style="background-color: var(--accent-secondary);">
                            üîÑ Refresh NASA Data
                        </button>
                    </aside>

                    <div class="events-content">
                        <!-- Loading Progress Bar -->
                        <div id="loadingProgress" class="loading-progress-container" style="display: none;">
                            <div class="loading-progress-bar">
                                <div id="loadingProgressFill" class="loading-progress-fill"></div>
                            </div>
                            <div id="loadingProgressText" class="loading-progress-text">Loading events...</div>
                        </div>
                        <section class="controls-section">
                            <div class="search-container">
                                <input 
                                    type="text" 
                                    id="searchInput" 
                                    class="search-input" 
                                    placeholder="Search events..."
                                    aria-label="Search events"
                                >
                            </div>

                            <div class="location-container">
                                <div class="location-info">
                                    <div class="location-status-wrapper">
                                        <span id="locationStatus" class="location-status">üìç Using default location: La Brea, Trinidad & Tobago</span>
                                        <span class="location-privacy">Your location is only used locally and never shared with external services.</span>
                                    </div>
                                    <div class="location-buttons">
                                        <button id="locationButton" class="location-button" aria-label="Request location access">
                                            üìç Use My Location
                                        </button>
                                        <button id="clearLocationButton" class="location-button location-button-secondary" aria-label="Clear saved location" style="display: none;">
                                            üîÑ Reset
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </section>

                        <section class="events-section">
                            <div id="eventsContainer" class="events-container" role="list">
                                <!-- Events will be dynamically rendered here -->
                            </div>
                        </section>
                    </div>
                </div>

            <section id="eventDetail" class="event-detail-section" aria-live="polite">
                <!-- Event details will be populated dynamically -->
            </section>
            </section>

            <!-- GIBS Satellite Imagery Section -->
            <section id="gibs-section" class="content-section">
                <div class="section-header">
                    <h2>üõ∞Ô∏è Satellite Imagery Explorer</h2>
                    <p class="section-description">Explore Earth using NOAA GOES satellite imagery and map views</p>
                </div>
                
                <div class="map-controls">
                    <div class="layer-controls">
                        <label for="gibs-layer-select" class="label">Choose Satellite Layer:</label>
                        <select id="gibs-layer-select" class="layer-select">
                            <option value="OpenStreetMap" selected>OpenStreetMap (Map View - Recommended)</option>
                            <option value="NOAA_GOES_East">NOAA GOES-East GeoColor (Satellite - May show errors)</option>
                            <option value="NOAA_GOES_West">NOAA GOES-West GeoColor (Satellite - May show errors)</option>
                        </select>
                    </div>
                    <button id="centerMapButton" class="map-button">üìç Center on My Location</button>
                    <button id="centerDefaultButton" class="map-button">üìç Center on La Brea</button>
                </div>
                
                <div id="gibs-map" class="map-container" style="height: 500px; margin-top: 1rem; border-radius: 10px; overflow: hidden;"></div>
                <div class="map-info">
                    <p>Pan and zoom to explore satellite imagery. Use the layer selector to switch between different views.</p>
                </div>
            </section>

            <!-- Interactive Sky Map Section -->
            <section id="sky-section" class="content-section">
                <div class="section-header">
                    <h2>‚≠ê Interactive Sky Map</h2>
                    <p class="section-description">Explore the night sky over your location using Stellarium Web</p>
                </div>
                
                <div class="sky-controls">
                    <button id="use-geolocation" class="sky-button">üìç Use My Location</button>
                </div>
                
                <div style="width: 100%; height: 500px; margin-top: 1rem; border-radius: 10px; overflow: hidden; background: var(--bg-secondary);">
                    <iframe
                        id="stellarium-frame"
                        src="https://stellarium-web.org/sky#lat=10.25&lng=-61.63&fov=60"
                        style="width: 100%; height: 100%; border: none;"
                        allowfullscreen
                        loading="lazy"
                        title="Stellarium Web Sky Map">
                    </iframe>
                </div>
            </section>

            <!-- Glossary Section -->
            <section id="glossary-section" class="content-section">
                <div class="section-header">
                    <h2>üìñ Glossary</h2>
                    <p class="section-description">Common acronyms and terms used in this application</p>
                </div>
                
                <div class="glossary-container">
                    <div class="glossary-category">
                        <h3>NASA APIs & Services</h3>
                        <div class="glossary-items">
                            <div class="glossary-item">
                                <strong>APOD</strong>
                                <p>Astronomy Picture of the Day - A daily image or video of our fascinating universe, along with a brief explanation written by a professional astronomer.</p>
                            </div>
                            <div class="glossary-item">
                                <strong>DONKI</strong>
                                <p>Space Weather Database Of Notifications, Knowledge, Information - NASA's comprehensive database for space weather events including solar flares and coronal mass ejections.</p>
                            </div>
                            <div class="glossary-item">
                                <strong>EONET</strong>
                                <p>Earth Observatory Natural Event Tracker - A system that tracks natural events on Earth such as wildfires, storms, and volcanic activity that may be visible from space.</p>
                            </div>
                            <div class="glossary-item">
                                <strong>GIBS</strong>
                                <p>Global Imagery Browse Services - NASA's system for providing satellite imagery and Earth observation data in a standardized format.</p>
                            </div>
                        </div>
                    </div>

                    <div class="glossary-category">
                        <h3>Space Weather Terms</h3>
                        <div class="glossary-items">
                            <div class="glossary-item">
                                <strong>CME</strong>
                                <p>Coronal Mass Ejection - A massive burst of solar wind and magnetic fields rising above the solar corona or being released into space. CMEs can affect Earth's magnetosphere and cause geomagnetic storms.</p>
                            </div>
                            <div class="glossary-item">
                                <strong>Solar Flare</strong>
                                <p>A sudden flash of increased brightness on the Sun, usually observed near its surface and in close proximity to a sunspot group. Flares are classified by their X-ray intensity (A, B, C, M, or X class).</p>
                            </div>
                            <div class="glossary-item">
                                <strong>FLR</strong>
                                <p>Solar Flare - The abbreviation used in NASA's DONKI database for solar flare events.</p>
                            </div>
                        </div>
                    </div>

                    <div class="glossary-category">
                        <h3>Spacecraft & Stations</h3>
                        <div class="glossary-items">
                            <div class="glossary-item">
                                <strong>ISS</strong>
                                <p>International Space Station - A modular space station in low Earth orbit. It's the largest human-made object in space and can be seen from Earth with the naked eye.</p>
                            </div>
                        </div>
                    </div>

                    <div class="glossary-category">
                        <h3>Astronomy Terms</h3>
                        <div class="glossary-items">
                            <div class="glossary-item">
                                <strong>Magnitude</strong>
                                <p>A measure of the brightness of a celestial object. Lower numbers indicate brighter objects. The brightest stars have negative magnitudes.</p>
                            </div>
                            <div class="glossary-item">
                                <strong>Elevation</strong>
                                <p>The angle between the object and the observer's local horizon. Objects at 0¬∞ are on the horizon, while 90¬∞ is directly overhead (zenith).</p>
                            </div>
                            <div class="glossary-item">
                                <strong>Azimuth</strong>
                                <p>The compass direction of an object, measured in degrees from north (0¬∞) through east (90¬∞), south (180¬∞), and west (270¬∞).</p>
                            </div>
                            <div class="glossary-item">
                                <strong>Meteor Shower</strong>
                                <p>A celestial event where numerous meteors are observed to radiate from one point in the night sky. These meteors are caused by streams of cosmic debris entering Earth's atmosphere.</p>
                            </div>
                            <div class="glossary-item">
                                <strong>Planet Visibility</strong>
                                <p>The times when planets are visible in the night sky from a specific location. Visibility depends on the planet's position relative to the Sun and Earth.</p>
                            </div>
                        </div>
                    </div>

                    <div class="glossary-category">
                        <h3>Technical Terms</h3>
                        <div class="glossary-items">
                            <div class="glossary-item">
                                <strong>CORS</strong>
                                <p>Cross-Origin Resource Sharing - A security feature that allows web pages to request resources from a different domain. Some APIs require server-side proxies to bypass CORS restrictions.</p>
                            </div>
                            <div class="glossary-item">
                                <strong>Open-Meteo</strong>
                                <p>A free, open-source weather API that provides astronomical data including sunrise/sunset times and moon phases without requiring an API key.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <footer class="main-footer">
            <p>Astronomy Events ‚Äì La Brea, Trinidad & Tobago</p>
            <p class="footer-credit">Built with vanilla JavaScript, HTML, and CSS</p>
        </footer>
    </div>

    <!-- Leaflet JS for GIBS map -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="script.js"></script>
    <script src="gibs-map.js"></script>
</body>
</html>

